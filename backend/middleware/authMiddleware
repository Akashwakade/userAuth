const jwt=require("jsonwebtoken")
const authMiddleware=(req,res,next)=>{
     const token=req.headers.authorization //taking token from headers
     if(token){ //if token is there then verify usgin jwt we also store the decoded token also
        const decoded=jwt.verify(token,"masai")
        if(decoded){
            next()
        }else{
            res.status(400).send({"msg":"Please login first!!!"})
        }
     } else{
            res.status(400).send({"msg":"Please login first!!!"})

     }
       
       
}
module.exports={authMiddleware}